package sec.web.domain.member;

import com.zaxxer.hikari.HikariDataSource;
import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.springframework.boot.test.context.SpringBootTest;
import sec.web.dbconnection.ConnectionConst;

import static org.junit.jupiter.api.Assertions.*;
import static sec.web.dbconnection.ConnectionConst.*;
@SpringBootTest
class MemberRepositoryTest {
    MemberRepository repository;

    @BeforeEach
    void beforeEach(){
        HikariDataSource dataSource = new HikariDataSource();
        dataSource.setJdbcUrl(URL);
        dataSource.setUsername(USERNAME);
        dataSource.setPassword(PASSWORD);

        repository = new MemberRepository(dataSource);
    }

    @Test
    void save() {
        Member testMember = new Member("test1", "testcode@test.com", "TestP@ssw0rd");

        repository.save(testMember);

        Member findMember = repository.findByEmail("testcode@test.com");
        Assertions.assertThat(testMember).isEqualTo(findMember);
    }


}