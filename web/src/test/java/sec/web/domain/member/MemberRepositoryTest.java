package sec.web.domain.member;

import com.zaxxer.hikari.HikariDataSource;
import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;
import org.springframework.boot.test.context.SpringBootTest;
import sec.web.dbconnection.ConnectionConst;

import static org.assertj.core.api.Assertions.*;
import static org.junit.jupiter.api.Assertions.*;
import static sec.web.dbconnection.ConnectionConst.*;
@SpringBootTest
class MemberRepositoryTest {
    MemberRepository repository;

    @BeforeEach
    void beforeEach(){
        HikariDataSource dataSource = new HikariDataSource();
        dataSource.setJdbcUrl(URL);
        dataSource.setUsername(USERNAME);
        dataSource.setPassword(PASSWORD);

        repository = new MemberRepository(dataSource);
    }

    @Test
    @DisplayName("회원가입 성공 테스트")
    void save() {
        Member testMember = new Member("test", "testman@test.com", "TestP@ssw0rd");

        repository.save(testMember);

        Member findMember = repository.find(testMember.getEmail());
        assertThat(testMember.getEmail()).isEqualTo(findMember.getEmail());
        repository.delete(findMember.getId());
    }
    
}