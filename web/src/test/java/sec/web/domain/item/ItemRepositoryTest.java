package sec.web.domain.item;

import com.zaxxer.hikari.HikariDataSource;
import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import sec.web.domain.member.MemberRepository;

import java.util.List;

import static org.assertj.core.api.Assertions.*;
import static org.junit.jupiter.api.Assertions.*;
import static sec.web.dbconnection.ConnectionConst.*;

class ItemRepositoryTest {
    ItemRepository itemRepository;

    @BeforeEach
    void beforeEach(){
        HikariDataSource dataSource = new HikariDataSource();
        dataSource.setJdbcUrl(URL);
        dataSource.setUsername(USERNAME);
        dataSource.setPassword(PASSWORD);

        itemRepository = new ItemRepository(dataSource);
    }
    @Test
    void CRUD_TEST(){
        Item itemTest = new Item(7L, "itemTest7", 6150, 14, "item7 description 테스트 중입니다.");
        //save
        itemRepository.save(itemTest);
        //find
        Item findItem = itemRepository.find(7L);
        assertThat(findItem.getDescription()).isEqualTo(itemTest.getDescription());
        //find all
        List<Item> itemList = itemRepository.findAll();
        assertThat(itemList.size()).isEqualTo(7);
        //findByMemberId
        List<Item> itemByMemberList = itemRepository.findByMemberId(7L);
        assertThat(itemByMemberList.size()).isEqualTo(4);
        assertThat(itemByMemberList).contains(findItem);
    }

}